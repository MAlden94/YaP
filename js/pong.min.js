if(typeof jQuery==="undefined"){document.write('<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>')}(function($){$.fn.doublekeypress=function(funcCall,deltaTime){var lastKeyCode=null;var lastKeyTime=0;if(!$.isNumeric(deltaTime)){deltaTime=600}return this.each(function(){$(this).keypress(function(event){var newKeyCode=event.which;if(newKeyCode==lastKeyCode){var newKeyTime=Date.now();if(newKeyTime-lastKeyTime<=deltaTime){lastKeyCode=null;newKeyTime=0;return funcCall(event)}lastKeyTime=newKeyTime}lastKeyCode=newKeyCode})})}})(jQuery);var Pong=function(){Pong=function(){return YaP_Object};window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,1e3/60)};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=clearTimeout;var YaP_Object=new Object;YaP_Object.Privates=new Object;YaP_Object.Privates.OldInputMethod=null;YaP_Object.Privates.InputMethods=[];YaP_Object.Privates.InputMethodNames={mousemove:"Mouse",keydown:"Keyboard",touchstart:"Touch",touchmove:"Drag",deviceorientation:"Gyroscope"};YaP_Object.Privates.LatestFrameLatency=0;YaP_Object.Privates.SafeFrameLatency=300;YaP_Object.Privates.title=document.title;YaP_Object.Privates.Blinker=null;YaP_Object.Privates.FrameID=null;YaP_Object.Privates.AI_Error=0;YaP_Object.Privates.AI_Depth=0;YaP_Object.Privates.p1_hit=false;YaP_Object.Privates.p2_hit=false;YaP_Object.Privates.P1InitSize=100;YaP_Object.Privates.P2InitSize=100;YaP_Object.Privates.ball_vy=5;YaP_Object.Privates.ball_vx=5;YaP_Object.Settings=new Object;YaP_Object.Settings.Level=5;YaP_Object.Settings.Player1Velocity=10;YaP_Object.Settings.Player2Velocity=10;YaP_Object.Settings.AI_difficulty=50;YaP_Object.Settings.AI_player=2;YaP_Object.Settings.degreeOfMotion=2;YaP_Object.Settings.GyroOffset=[0,0];YaP_Object.Settings.InputMethod="deviceorientation";YaP_Object.Settings.DualPaddles=false;YaP_Object.Settings.InvertControls=false;YaP_Object.Settings.AutoLevelUp=true;YaP_Object.Settings.Interactive=false;YaP_Object.Settings.Menu=false;YaP_Object.Settings.Paused=false;YaP_Object.Settings.ForcedPause=false;YaP_Object.Settings.MenuOnInteractiveReturn=false;YaP_Object.Settings.LevelChangesPaddleSize=true;YaP_Object.Settings.link_velocity_of_players=true;YaP_Object.Settings.FixBoundaryBug=false;YaP_Object.Functions=new Object;$(window).resize(function(){YaP_Object.Privates.window_height=$(window).height();YaP_Object.Privates.window_width=$(window).width()}).resize();$("body").append('<div id="PongTable"></div>');$("#PongTable").append('<span id="P1Score">0</span>');$("#PongTable").append('<span id="P2Score">0</span>');$("#PongTable").append('<span id="P1" title="I can has turn?"></span>');$("#PongTable").append('<span id="P2" title="Muahahaha!"></span>');$("#PongTable").append('<span id="Ball" title="Ouch!"></span>');YaP_Object.Privates.$p1_score=$("#PongTable #P1Score");YaP_Object.Privates.$p2_score=$("#PongTable #P2Score");YaP_Object.Privates.$p1=$("#PongTable #P1");YaP_Object.Privates.$p2=$("#PongTable #P2");YaP_Object.Privates.$ball=$("#PongTable #Ball");YaP_Object.Privates.P1InitSize=parseInt(YaP_Object.Privates.$p1.css("height"));YaP_Object.Privates.P2InitSize=parseInt(YaP_Object.Privates.$p2.css("height"));$.each(YaP_Object.Privates.InputMethodNames,function(index,value){if("on"+index in window){if(index=="deviceorientation"){if(window.DeviceOrientationEvent){var test=function(event){if(event.alpha==null||event.beta==null||event.gamma==null){$('#PongTable #_InputMethod option[value="'+index+'"]').remove();if(index==YaP_Object.Settings.InputMethod){YaP_Object.Settings.InputMethod="mousemove"}}window.removeEventListener(index,test,false)};window.addEventListener(index,test,false)}else{$('#PongTable #_InputMethod option[value="'+index+'"]').remove();if(index==YaP_Object.Settings.InputMethod){YaP_Object.Settings.InputMethod="mousemove"}}}YaP_Object.Privates.InputMethods.push(index)}});$("#PongTable").dblclick(function(){if(YaP_Object.Settings.Interactive)$("#pong_interactive_toggle").mouseup()}).on("doubletap",function(){$("#PongTable").dblclick()});$("#pong_btn_group").css("display","block");$("#pong_pause_toggle").css("display","inline").mouseup(function(){YaP_Object.Settings.ForcedPause=YaP_Object.Settings.Paused=!YaP_Object.Settings.Paused;$(window).off("focus",YaP_Object.Functions.focus);if(!YaP_Object.Settings.Paused){$(window).on("focus",YaP_Object.Functions.focus);YaP_Object.Settings.Menu=false}YaP_Object.Functions.Update()});$("#pong_interactive_toggle").css("display","inline").mouseup(function(event){YaP_Object.Settings.Interactive=!YaP_Object.Settings.Interactive;if(!YaP_Object.Settings.Interactive){YaP_Object.Settings.Menu=true}YaP_Object.Functions.toggleMenu()});YaP_Object.Functions.blur=function(){if(YaP_Object.Settings.Menu||YaP_Object.Settings.ForcedPause)return;YaP_Object.Settings.Paused=true;YaP_Object.Functions.Update();$(window).off("blur",YaP_Object.Functions.blur)};YaP_Object.Functions.focus=function(){if(YaP_Object.Settings.Menu||YaP_Object.Settings.ForcedPause)return;YaP_Object.Settings.Paused=false;YaP_Object.Functions.Update();$(window).on("blur",YaP_Object.Functions.blur)};$(window).on("focus",YaP_Object.Functions.focus);if(!YaP_Object.Settings.FixBoundaryBug){for(i=0;i<=YaP_Object.Privates.window_height/2&&!YaP_Object.Settings.FixBoundaryBug;i++){YaP_Object.Privates.$ball.css("top",i+"px");YaP_Object.Settings.FixBoundaryBug=YaP_Object.Privates.window_height-parseInt(YaP_Object.Privates.$ball.css("top"))-parseInt(YaP_Object.Privates.$ball.css("height"))!=parseInt(YaP_Object.Privates.$ball.css("bottom"))}}if(YaP_Object.Settings.FixBoundaryBug){}YaP_Object.Privates.$ball.css("left",YaP_Object.Privates.window_width/2+"px");YaP_Object.Privates.$ball.css("top",YaP_Object.Privates.window_height/2+"px");$("#PongTable").append('<div id="Menu">\r\n	<table>\r\n	  <tr>\r\n	      <td></td>\r\n	      <td><span id="blink" style="display: inline; text-align: center">Click outside the menu to close.</span></td>\r\n	      <td></td>\r\n	  </tr>\r\n	</table>\r\n	<table>\r\n	  <tr>\r\n	      <td>Level </td>\r\n	      <td><input id="_Level" max="100" min="1" type="number"></td>\r\n	      <td></td>\r\n	  </tr>\r\n	    <tr>\r\n		<td>\r\n		<select id="_AI_player">\r\n		    <option value="0">CPU: Off</option>\r\n		    <option value="2">CPU: P2</option>\r\n		    <option value="1">CPU: P1</option>\r\n		</select>\r\n		</td>\r\n		<td><input id="_AI_difficulty" max="100" min="0" type="number"></td>\r\n		<td>% difficulty</td>\r\n		<td></td>\r\n	    </tr>\r\n	    <tr>\r\n		<td>Input method</td>\r\n		<td id="degreeOfMotionlabel" style="display: none">&deg; Of Motion</td>\r\n		<td></td>\r\n	    </tr>\r\n	    <tr>\r\n	    <td><select id="_InputMethod"></select></td>\r\n	    <td><input id="_degreeOfMotion" max="360" min="0" type="number" style="display: none"></td>\r\n	    <td><button id="Calibrate">Calibrate</button></td>\r\n	    </td>\r\n	</table>\r\n	<table class="PlayerVelocity" style="display: none">\r\n	    <tr>\r\n		<td>P1</td>\r\n		<td></td>\r\n		<td>P2</td>\r\n	    </tr>\r\n	    <tr>\r\n		<td><input id="_Player1Velocity" max="100" min="1" type="number"></td>\r\n		<td><input id="_link_velocity_of_players" type="checkbox"></td>\r\n		<td><input id="_Player2Velocity" max="100" min="1" type="number"></td>\r\n		<td>velocity</td>\r\n	    </tr>\r\n	</table>\r\n	<hr>\r\n	<table>\r\n	<tr>\r\n	<td></td>\r\n	<td>\r\n	<input id="_DualPaddles"    type="checkbox">Dual Paddles<br>\r\n	<input id="_InvertControls" type="checkbox">Invert Controls<br>\r\n	<input id="_AutoLevelUp"    type="checkbox">Automatically Level up<br>\r\n	<input id="_Interactive"    type="checkbox">Interactive<br>\r\n	<input id="_Paused"         type="checkbox">Paused<br>\r\n	</td>\r\n	<td></td>\r\n	</tr>\r\n	</table>\r\n	<table>\r\n	<td><a id="ResetScores"   href="#">Reset scores</a></td>\r\n	<td>&nbsp;</td>\r\n	<td><a id="ResetSettings" href="#">Default settings</a></td>\r\n	</tr>\r\n	</table>\r\n	<table>\r\n	<tr>\r\n	<td></td>\r\n	<td>+/-: Level | A/Z: P1 | J/M: P2 | <a id="Info" href="#">Info</a></td>\r\n	<td></td>\r\n	</tr>\r\n	</table>\r\n	</div><div id="About">Copyright (C) 2012-2016 Mitchell Lafferty &lt;<a href="http://linuxrules94.users.sf.net/">http://linuxrules94.users.sf.net/</a>&gt; <coolspeedy6 at gmail dot com><br>\r\n	Released under the GNU GPL.<br>\r\n	Please read the source code for more info. (pong.js)<br>\r\n	<a id="MyBitcoin" href="bitcoin:16tpxvjpPKhMUGhZkRU9s9UhuKZMuFBVfz?label=Donations%20Address%20for%20linuxrules94"><em>Bitcoin donations :)</em></a></div>');$.each(YaP_Object.Privates.InputMethods,function(index,value){$("#PongTable #_InputMethod").append($("<option/>",{value:value,text:YaP_Object.Privates.InputMethodNames[value]!==undefined?YaP_Object.Privates.InputMethodNames[value]:value}))});$("#PongTable").find("#_AI_player, #_degreeOfMotion, #_AI_difficulty").change(function(){YaP_Object.Settings[this.id.substr(1)]=parseInt(this.value)}).keyup(function(){$(this).change()});$("#PongTable #_InputMethod").change(function(){$("#PongTable").find(".PlayerVelocity, #_degreeOfMotion, #degreeOfMotionlabel, #Calibrate").hide();switch(this.value){case"deviceorientation":$("#PongTable").find("#_degreeOfMotion, #degreeOfMotionlabel, #Calibrate").show();break;case"keydown":$("#PongTable .PlayerVelocity").show();break;default:if(YaP_Object.Privates.InputMethodNames[this.value]==undefined){$(this).val(YaP_Object.Settings.InputMethod)}break}YaP_Object.Settings.InputMethod=this.value});$("#PongTable").find("#_Level, #_Player1Velocity, #_Player2Velocity").change(function(){YaP_Object.Settings[this.id.substr(1)]=this.value=$.isNumeric(this.value)?this.value:YaP_Object.Settings[this.id.substr(1)];if(YaP_Object.Settings.link_velocity_of_players){switch(this.id){case"_Player1Velocity":if(YaP_Object.Settings.link_velocity_of_players){$("#PongTable #_Player2Velocity").val(YaP_Object.Settings.Player2Velocity=YaP_Object.Settings.Player1Velocity)}return;case"_Player2Velocity":if(YaP_Object.Settings.link_velocity_of_players){$("#PongTable #_Player1Velocity").val(YaP_Object.Settings.Player1Velocity=YaP_Object.Settings.Player2Velocity)}return;case"_Level":YaP_Object.Functions.UpdateLevel(2);return}}}).keyup(function(){$(this).change()});$('#PongTable input[type="checkbox"]').click(function(){YaP_Object.Settings[this.id.substr(1)]=this.checked;switch(this.id){case"_Paused":if(this.checked){YaP_Object.Settings.Menu=false;YaP_Object.Functions.Update()}return;case"_DualPaddles":$("#PongTable #_AI_player").attr("disabled",this.checked);return}});$("#PongTable").find("#Calibrate, #ResetScores, #ResetSettings, #Info").click(function(event){event.preventDefault();switch(this.id){case"Calibrate":if($("#PongTable #Calibrate").text().indexOf("Confirm")!=-1){$("#PongTable #Calibrate").text("Calibrate")}else{$("#PongTable #Calibrate").text("Confirm")}return;case"ResetScores":YaP_Object.Privates.$p1_score.add(YaP_Object.Privates.$p2_score).text(0);return;case"ResetSettings":localStorage.clear();location.reload();return;case"Info":$("#About").slideToggle(1e3);return}});$("#PongTable").find("#Menu, #About").each(function(){$(this).css({"margin-left":-$(this).outerWidth()/2+"px","margin-top":-$(this).outerHeight()/2+"px"}).click(function(event){event.stopPropagation();if(this.id=="About")$(this).fadeOut(1e3)}).fadeOut(0)});$("#PongTable #Menu").dblclick(function(event){event.stopPropagation()}).on("doubletap",function(event){event.stopPropagation()});$("body").click(function(event){if($(event.target).is("a, button, span"))return;if(YaP_Object.Settings.Menu){YaP_Object.Functions.toggleMenu();$("#PongTable #About").fadeOut(1e3)}});if(typeof Storage!=="undefined"){for(param in YaP_Object.Settings){if(localStorage[param]===undefined){continue}try{YaP_Object.Settings[param]=JSON.parse(localStorage[param])}catch(e){}}}$(document).keypress(function(event){YaP_Object.Functions.GlobalKeyboardHandler(event)});$(document).doublekeypress(function(event){if(event.which==112)YaP_Object.Functions.toggleMenu()});YaP_Object.Functions.Update=function(){if(YaP_Object.Settings.Menu){$("#PongTable #_Level").val(YaP_Object.Settings.Level);$("#PongTable #_Player1Velocity").val(YaP_Object.Settings.Player1Velocity);$("#PongTable #_Player2Velocity").val(YaP_Object.Settings.Player2Velocity);$("#PongTable #_AI_difficulty").val(YaP_Object.Settings.AI_difficulty);$("#PongTable #_AI_player").val(YaP_Object.Settings.AI_player);$("#PongTable #_InputMethod").val(YaP_Object.Settings.InputMethod).change();$("#PongTable #_degreeOfMotion").val(YaP_Object.Settings.degreeOfMotion);$("#PongTable #_DualPaddles").attr("checked",YaP_Object.Settings.DualPaddles);$("#PongTable #_AutoLevelUp").attr("checked",YaP_Object.Settings.AutoLevelUp);$("#PongTable #_Interactive").attr("checked",YaP_Object.Settings.Interactive);$("#PongTable #_Paused").attr("checked",false);$("#PongTable #_AI_player").attr("disabled",YaP_Object.Settings.DualPaddles);$("#PongTable #_link_velocity_of_players").attr("checked",YaP_Object.Settings.link_velocity_of_players);$("#PongTable #Menu").slideDown(1e3);if(!YaP_Object.Privates.Blinker){YaP_Object.Privates.Blinker=setInterval(function(){$("#PongTable #blink").fadeToggle(500)},500)}}else{clearInterval(YaP_Object.Privates.Blinker);YaP_Object.Privates.Blinker=null;$("#PongTable #Calibrate").text("Calibrate");$("#PongTable #Menu, #About").fadeOut(500)}YaP_Object.Functions.UpdateLevel(2);$("#pong_menu_toggle").text((YaP_Object.Settings.Menu?"close":"open")+" pong menu");$("#pong_pause_toggle").text((YaP_Object.Settings.Paused?"play":"pause")+" pong");$("#pong_interactive_toggle").text((YaP_Object.Settings.Interactive?"quit":"start")+" pong");if(YaP_Object.Settings.Interactive){if(YaP_Object.Settings.MenuOnInteractiveReturn){YaP_Object.Settings.Menu=true}if(!$("#PongTable").hasClass("interactive")){$("#PongTable").addClass("interactive")}}else{$("#PongTable").removeClass("interactive")}switch(YaP_Object.Privates.OldInputMethod){case"deviceorientation":case"touchstart":case"touchend":case"touchmove":window.removeEventListener(YaP_Object.Settings.InputMethod,YaP_Object.Functions.EventHandler);break;default:$(window).off(YaP_Object.Privates.OldInputMethod,YaP_Object.Functions.EventHandler)}if(jQuery.inArray(YaP_Object.Settings.InputMethod,YaP_Object.Privates.InputMethods)==-1){YaP_Object.Settings.InputMethod=YaP_Object.Privates.InputMethods[0]}if(YaP_Object.Settings.Interactive){YaP_Object.Privates.OldInputMethod=YaP_Object.Settings.InputMethod;switch(YaP_Object.Privates.OldInputMethod){case"deviceorientation":case"touchstart":case"touchend":case"touchmove":window.addEventListener(YaP_Object.Settings.InputMethod,YaP_Object.Functions.EventHandler);break;default:$(window).on(YaP_Object.Settings.InputMethod,YaP_Object.Functions.EventHandler)}}if(YaP_Object.Settings.DualPaddles){YaP_Object.Settings.AI_player=0}if(!YaP_Object.Settings.Paused){if(!YaP_Object.Privates.FrameID){YaP_Object.Privates.FrameID=window.requestAnimationFrame(YaP_Object.Functions._newframe)}}else{if(YaP_Object.Settings.ForcedPause){YaP_Object.Privates.$ball.css({top:50+"px",left:20+"px"});YaP_Object.Privates.$p2.css("top",YaP_Object.Privates.window_height-parseInt(YaP_Object.Privates.$p2.css("height")))}window.cancelAnimationFrame(YaP_Object.Privates.FrameID);YaP_Object.Privates.FrameID=null}if(typeof Storage!=="undefined"){for(param in YaP_Object.Settings){try{localStorage[param]=JSON.stringify(YaP_Object.Settings[param])}catch(e){}}}};YaP_Object.Functions.toggleMenu=function(){YaP_Object.Settings.Paused=YaP_Object.Settings.Menu=!YaP_Object.Settings.Menu;if(YaP_Object.Settings.Menu){YaP_Object.Settings.Interactive=true;if($("#pong_scroll_to").length){window.scrollTo(0,$("#pong_scroll_to").position().top)}else if($("#pong_btn_group").length){window.scrollTo(0,$("#pong_btn_group").position().top)}else{window.scrollTo(0,$("#pong_interactive_toggle").position().top)}}YaP_Object.Functions.Update();return YaP_Object.Settings.Menu};YaP_Object.Functions.UpdateLevel=function(mode){switch(mode){case 0:YaP_Object.Settings.Level++;break;case 1:YaP_Object.Settings.Level--;break;default:}YaP_Object.Settings.Level=constrain(YaP_Object.Settings.Level,1,100);YaP_Object.Privates.ball_vy=(YaP_Object.Privates.ball_vy<0?-1:1)*YaP_Object.Settings.Level;YaP_Object.Privates.ball_vx=(YaP_Object.Privates.ball_vx<0?-1:1)*YaP_Object.Settings.Level;if(YaP_Object.Settings.LevelChangesPaddleSize){YaP_Object.Privates.$p1.css("height",constrain(Math.ceil(YaP_Object.Privates.P1InitSize-YaP_Object.Settings.Level*2.5/100*YaP_Object.Privates.P1InitSize),15,YaP_Object.Privates.P1InitSize)+"px");YaP_Object.Privates.$p2.css("height",constrain(Math.ceil(YaP_Object.Privates.P2InitSize-YaP_Object.Settings.Level*2.5/100*YaP_Object.Privates.P2InitSize),15,YaP_Object.Privates.P2InitSize)+"px")}if(YaP_Object.Settings.Interactive){document.title="Pong Level: "+YaP_Object.Settings.Level}else{document.title=YaP_Object.Privates.title}};YaP_Object.Functions._newframe=function(){if(!YaP_Object.Settings.Paused){window.requestAnimationFrame(YaP_Object.Functions._newframe)}var start=(new Date).getMilliseconds();if(YaP_Object.Settings.FixBoundaryBug){YaP_Object.Privates.$p1.css("bottom",YaP_Object.Privates.window_height-parseInt(YaP_Object.Privates.$p1.css("top"))-parseInt(YaP_Object.Privates.$p1.css("height"))+"px");YaP_Object.Privates.$p2.css("bottom",YaP_Object.Privates.window_height-parseInt(YaP_Object.Privates.$p2.css("top"))-parseInt(YaP_Object.Privates.$p2.css("height"))+"px");YaP_Object.Privates.$ball.css("bottom",YaP_Object.Privates.window_height-parseInt(YaP_Object.Privates.$ball.css("top"))-parseInt(YaP_Object.Privates.$ball.css("height"))+"px");YaP_Object.Privates.$ball.css("right",YaP_Object.Privates.window_width-parseInt(YaP_Object.Privates.$ball.css("left"))-parseInt(YaP_Object.Privates.$ball.css("width"))+"px")}ball_top=parseInt(YaP_Object.Privates.$ball.css("top"));ball_bottom=parseInt(YaP_Object.Privates.$ball.css("bottom"));ball_left=parseInt(YaP_Object.Privates.$ball.css("left"));ball_right=parseInt(YaP_Object.Privates.$ball.css("right"));p1_top=parseInt(YaP_Object.Privates.$p1.css("top"));p1_bottom=parseInt(YaP_Object.Privates.$p1.css("bottom"));p1_left=parseInt(YaP_Object.Privates.$p1.css("left"));p1_width=parseInt(YaP_Object.Privates.$p1.css("width"));p1_height=parseInt(YaP_Object.Privates.$p1.css("height"));p2_top=parseInt(YaP_Object.Privates.$p2.css("top"));p2_bottom=parseInt(YaP_Object.Privates.$p2.css("bottom"));p2_right=parseInt(YaP_Object.Privates.$p2.css("right"));p2_width=parseInt(YaP_Object.Privates.$p2.css("width"));p2_height=parseInt(YaP_Object.Privates.$p2.css("height"));if(!YaP_Object.Settings.Interactive){YaP_Object.Settings.AI_player=YaP_Object.Privates.ball_vx<0?1:2}if(YaP_Object.Settings.AI_player==1&&YaP_Object.Privates.ball_vx<0&&ball_left<YaP_Object.Privates.AI_Depth||YaP_Object.Settings.AI_player==2&&YaP_Object.Privates.ball_vx>0&&ball_right<YaP_Object.Privates.AI_Depth){var AI_vy=1;var AI_ID=YaP_Object.Privates.$p1;if(YaP_Object.Settings.AI_player==1){if(YaP_Object.Settings.InputMethod=="keydown"){AI_vy=YaP_Object.Settings.Player1Velocity}}else{if(YaP_Object.Settings.InputMethod=="keydown"){AI_vy=YaP_Object.Settings.Player2Velocity}AI_ID=YaP_Object.Privates.$p2}if(YaP_Object.Settings.DualPaddles){AI_ID=YaP_Object.Privates.$p1.add(YaP_Object.Privates.$p2)}var ball_pos=ball_top-(parseInt($(AI_ID).css("height"))/2+YaP_Object.Privates.AI_Error)*(YaP_Object.Privates.ball_vy<0?-1:1);if(YaP_Object.Privates.ball_vy<0){for(i=parseInt($(AI_ID).css("top"));i>=ball_pos;i-=AI_vy){$(AI_ID).css("top",i+"px")}}else{for(i=parseInt($(AI_ID).css("top"));i<=ball_pos;i+=AI_vy){$(AI_ID).css("top",i+"px")}}if(parseInt($(AI_ID).css("top"))+parseInt($(AI_ID).css("height"))>YaP_Object.Privates.window_height){$(AI_ID).css("top",YaP_Object.Privates.window_height-parseInt($(AI_ID).css("height"))+"px")}if(parseInt($(AI_ID).css("top"))<0)$(AI_ID).css("top","0px")}if(ball_top<=Math.abs(YaP_Object.Privates.ball_vy)||ball_bottom<=Math.abs(YaP_Object.Privates.ball_vy)){YaP_Object.Privates.ball_vy*=-1}if(!YaP_Object.Privates.p2_hit&&ball_top+Math.abs(YaP_Object.Privates.ball_vy)>=p2_top&&ball_bottom+Math.abs(YaP_Object.Privates.ball_vy)>=p2_bottom&&ball_right-Math.abs(YaP_Object.Privates.ball_vx)<=p2_right+p2_width){if(!YaP_Object.Settings.DualPaddles){YaP_Object.Privates.$p2_score.text(parseInt(YaP_Object.Privates.$p2_score.text())+1)}else{YaP_Object.Privates.$p1_score.text(parseInt(YaP_Object.Privates.$p1_score.text())+1)}YaP_Object.Privates.ball_vx*=-1;if(YaP_Object.Settings.AI_player==2||!YaP_Object.Settings.Interactive){YaP_Object.Functions.SetAI_Error(p1_height)}YaP_Object.Privates.p1_hit=false;YaP_Object.Privates.p2_hit=true;if(YaP_Object.Settings.AutoLevelUp&&!(parseInt(YaP_Object.Privates.$p1_score.text())^5)){YaP_Object.Functions.UpdateLevel(0)}}else{if(ball_right<=Math.abs(YaP_Object.Privates.ball_vx)){if(YaP_Object.Settings.AI_player==2||!YaP_Object.Settings.Interactive){YaP_Object.Functions.SetAI_Error(p2_height)}if(!YaP_Object.Settings.DualPaddles){YaP_Object.Privates.$p1_score.text(parseInt(YaP_Object.Privates.$p1_score.text())+1)}else{YaP_Object.Privates.$p2_score.text(parseInt(YaP_Object.Privates.$p2_score.text())+1)}ball_left=YaP_Object.Privates.window_width/2;ball_top=YaP_Object.Privates.window_height/2;YaP_Object.Privates.p1_hit=false;YaP_Object.Privates.p2_hit=false;if(YaP_Object.Settings.AutoLevelUp){YaP_Object.Functions.UpdateLevel(YaP_Object.Settings.Level=0)}}}if(!YaP_Object.Privates.p1_hit&&ball_top+Math.abs(YaP_Object.Privates.ball_vy)>=p1_top&&ball_bottom+Math.abs(YaP_Object.Privates.ball_vy)>=p1_bottom&&ball_left-Math.abs(YaP_Object.Privates.ball_vx)<=p1_left+p1_width){YaP_Object.Privates.$p1_score.text(parseInt(YaP_Object.Privates.$p1_score.text())+1);YaP_Object.Privates.ball_vx*=-1;if(YaP_Object.Settings.AI_player==1||!YaP_Object.Settings.Interactive){YaP_Object.Functions.SetAI_Error(p2_height)}YaP_Object.Privates.p1_hit=true;YaP_Object.Privates.p2_hit=false;if(YaP_Object.Settings.AutoLevelUp&&!(parseInt(YaP_Object.Privates.$p1_score.text())^5))YaP_Object.Functions.UpdateLevel(0)}else{if(ball_left<=Math.abs(YaP_Object.Privates.ball_vx)){if(YaP_Object.Settings.AI_player==1||!YaP_Object.Settings.Interactive){YaP_Object.Functions.SetAI_Error(p1_height)}YaP_Object.Privates.$p2_score.text(parseInt(YaP_Object.Privates.$p2_score.text())+1);ball_left=YaP_Object.Privates.window_width/2;ball_top=YaP_Object.Privates.window_height/2;if(YaP_Object.Settings.AutoLevelUp){YaP_Object.Functions.UpdateLevel(YaP_Object.Settings.Level=0)}YaP_Object.Privates.p1_hit=false;YaP_Object.Privates.p2_hit=false}}ball_top+=YaP_Object.Privates.ball_vy;ball_left+=YaP_Object.Privates.ball_vx;YaP_Object.Privates.$ball.css({top:ball_top+"px",left:ball_left+"px"});if((YaP_Object.Privates.LatestFrameLatency=(new Date).getMilliseconds()-start)>YaP_Object.Privates.SafeFrameLatency){if(YaP_Object.Settings.Interactive){YaP_Object.Settings.Interactive=false;alert("Pong has been paused because it may freeze or slow down browser. Consider upgrading browser or computer if possible.")}else{}$("#pong_pause_toggle").mouseup()}};YaP_Object.Functions.SetAI_Error=function(player_height){YaP_Object.Privates.AI_Error=Math.random()*(2*player_height*(1-YaP_Object.Settings.AI_difficulty/100))*(Math.random()>.5?1:-1);YaP_Object.Privates.AI_Depth=Math.random()*YaP_Object.Privates.window_width*(YaP_Object.Settings.AI_difficulty/100)};YaP_Object.Functions.EventHandler=function(event){if(!YaP_Object.Settings.Interactive||event.type!=YaP_Object.Settings.InputMethod)return;switch(event.type){case"keydown":return YaP_Object.Functions.KeyboardHandler(event);case"mousemove":case"onwheel":return YaP_Object.Functions.MouseHandler(event);case"touchstart":case"touchmove":case"touchend":return YaP_Object.Functions.TouchHandler(event);case"deviceorientation":return YaP_Object.Functions.deviceorientationHandler(event)}};YaP_Object.Functions.deviceorientationHandler=function(event){if(event.gamma==null||event.beta==null){$('#PongTable #_InputMethod option[value="deviceorientation"]').remove();YaP_Object.Settings.InputMethod="mousemove";YaP_Object.Functions.Update();return true}if($("#PongTable #Calibrate").text().indexOf("Confirm")!=-1){index=(Math.abs(window.orientation)==90)+0;YaP_Object.Settings.GyroOffset[index]=index?event.gamma:event.beta;$("#PongTable #Calibrate").text("Confirm ["+pad(parseInt(YaP_Object.Settings.GyroOffset[index]),4)+"]");return}if(YaP_Object.Settings.DualPaddles){var $real_player=YaP_Object.Privates.$p1.add(YaP_Object.Privates.$p2)}else{var $real_player=YaP_Object.Settings.AI_player==2?YaP_Object.Privates.$p1:YaP_Object.Privates.$p2}$real_player.css("top",map(constrain(Math.abs(window.orientation)==90?(event.gamma-YaP_Object.Settings.GyroOffset[1])*(YaP_Object.Settings.InvertControls?-1:1):(event.beta-YaP_Object.Settings.GyroOffset[0])*(YaP_Object.Settings.InvertControls?-1:1),-YaP_Object.Settings.degreeOfMotion,YaP_Object.Settings.degreeOfMotion),-YaP_Object.Settings.degreeOfMotion,YaP_Object.Settings.degreeOfMotion,0,YaP_Object.Privates.window_height-parseInt($real_player.css("height")))+"px");return true};YaP_Object.Functions.TouchHandler=function(event){if(event.type=="touchmove"){event.preventDefault()}var $real_player=null;if(YaP_Object.Settings.DualPaddles){$real_player=YaP_Object.Privates.$p1.add(YaP_Object.Privates.$p2)}else{if(YaP_Object.Settings.AI_player>0){$real_player=YaP_Object.Settings.AI_player==2?YaP_Object.Privates.$p1:YaP_Object.Privates.$p2}else{$real_player=event.touches[0].pageX<YaP_Object.Privates.window_width/2?YaP_Object.Privates.$p1:YaP_Object.Privates.$p2}}$real_player.css("top",constrain(event.touches[0].pageY-$(document).scrollTop()-parseInt($real_player.css("height"))/2,0,YaP_Object.Privates.window_height-parseInt($real_player.css("height")))+"px");return true};YaP_Object.Functions.MouseHandler=function(event){if(YaP_Object.Settings.DualPaddles){var $real_player=YaP_Object.Privates.$p1.add(YaP_Object.Privates.$p2)}else{if(YaP_Object.Settings.AI_player>0){$real_player=YaP_Object.Settings.AI_player==2?YaP_Object.Privates.$p1:YaP_Object.Privates.$p2}else{$real_player=event.pageX<YaP_Object.Privates.window_width/2?YaP_Object.Privates.$p1:YaP_Object.Privates.$p2}}var PageY=YaP_Object.Settings.InvertControls?YaP_Object.Privates.window_height-(event.pageY-$(document).scrollTop()):event.pageY-$(document).scrollTop();$real_player.css("top",constrain(Math.round(PageY-parseInt($real_player.css("height"))/2),0,YaP_Object.Privates.window_height-parseInt($real_player.css("height")))+"px");return true};YaP_Object.Functions.KeyboardHandler=function(event){p1_top=parseInt(YaP_Object.Privates.$p1.css("top"));p1_bottom=parseInt(YaP_Object.Privates.$p1.css("bottom"));p2_top=parseInt(YaP_Object.Privates.$p2.css("top"));p2_bottom=parseInt(YaP_Object.Privates.$p2.css("bottom"));switch(event.which){case 65:if(YaP_Object.Settings.AI_player==1)return;if(p1_top>0){p1_top-=YaP_Object.Settings.Player1Velocity}break;case 90:if(YaP_Object.Settings.AI_player==1)return;if(p1_bottom>0){p1_top+=YaP_Object.Settings.Player1Velocity}break;case 74:if(YaP_Object.Settings.AI_player==2)return;if(p2_top>0){p2_top-=YaP_Object.Settings.Player2Velocity}break;case 77:if(YaP_Object.Settings.AI_player==2)return;if(p2_bottom>0){p2_top+=YaP_Object.Settings.Player2Velocity}break}if(YaP_Object.Settings.DualPaddles){p1_top=p2_top}YaP_Object.Privates.$p1.css({top:p1_top+"px"});YaP_Object.Privates.$p2.css({top:p2_top+"px"});return true};YaP_Object.Functions.GlobalKeyboardHandler=function(event){if(!YaP_Object.Settings.Interactive)return;switch(event.which){case 43:case 61:YaP_Object.Functions.UpdateLevel(0);break;case 45:YaP_Object.Functions.UpdateLevel(1);break}return true};function constrain(value,min,max){if(value<min){return min}else if(value>max){return max}return value}function map(value,inMin,inMax,outMin,outMax){return(value-inMin)*(outMax-outMin)/(inMax-inMin)+outMin}function pad(str,min){str=str.toString();return str.length<min?pad(str+" ",min):str}YaP_Object.Functions.Update();return YaP_Object};